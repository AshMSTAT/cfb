# ,champ_info      = rawfromJSON$scoreboard$games[[k]]$champInfo
#     ,videos          = rawfromJSON$scoreboard$games[[k]]$videos
#     ,score_breakdown = rawfromJSON$scoreboard$games[[k]]$scoreBreakdown
#     ,home            =
#     ,away            = rawfromJSON$scoreboard$games[[k]]$away
#     ,tabs            = rawfromJSON$scoreboard$games[[k]]$tabs
#     ,tabs_array      = rawfromJSON$scoreboard$games[[k]]$tabsArray
#     ,status          = rawfromJSON$scoreboard$games[[k]]$status
#     ,alerts          = rawfromJSON$scoreboard$games[[k]]$alerts
)
}
k = 1
HomeStuff <- rawfromJSON$scoreboard$games[[k]]$home
colnames(HomeStuff) = paste0('home.', colnames(HomeStuff))
homeQuarters <- data.frame(do.call(rbind, HomeStuff$home.scoreBreakdown))
colnames(homeQuarters) = c('home.quarter1.score','home.quarter2.score','home.quarter3.score','home.quarter4.score')
AwayStuff <- rawfromJSON$scoreboard$games[[k]]$home
colnames(AwayStuff) = paste0('away.', colnames(AwayStuff))
awayQuarters <- data.frame(do.call(rbind, AwayStuff$away.scoreBreakdown))
colnames(awayQuarters) = c('away.quarter1.score','away.quarter2.score','away.quarter3.score','away.quarter4.score')
HomeAway <- data.frame(
HomeStuff %>% dplyr::select(-home.scoreBreakdown)
,sapply(homeQuarters, as.numeric)
,AwayStuff %>% dplyr::select(-away.scoreBreakdown)
,sapply(awayQuarters, as.numeric)
)
jsonLinks <- foreach(i = 1:length(rawfromJSON$scoreboard$games[[k]]$tabsArray), .combine = 'rbind') %do% {
tabsarray <- rawfromJSON$scoreboard$games[[k]]$tabsArray[[i]][[1]]
recapURL = tabsarray$file[tabsarray$title == 'Recap']
boxScoreURL = tabsarray$file[tabsarray$title == 'Box Score']
scoringURL = tabsarray$file[tabsarray$title == 'Scoring']
teamStatsURL = tabsarray$file[tabsarray$title == 'Team Stats']
pbpURL = tabsarray$file[tabsarray$title == 'Play-By-Play']
data.frame(
recapURL = ifelse(length(recapURL) == 0, NA, recapURL)
,boxScoreURL = ifelse(length(boxScoreURL) == 0, NA, boxScoreURL)
,scoringURL = ifelse(length(scoringURL) == 0, NA, scoringURL)
,teamStatsURL = ifelse(length(teamStatsURL) == 0, NA, teamStatsURL)
,pbpURL = ifelse(length(pbpURL) == 0, NA, pbpURL)
)
}
rawfromJSON$scoreboard$games[[k]]$tabsArray
data.frame(
ncaa_id          = rawfromJSON$scoreboard$games[[k]]$id
,conference      = rawfromJSON$scoreboard$games[[k]]$conference
,game_state      = rawfromJSON$scoreboard$games[[k]]$gameState
,start_ts        = as.POSIXct(as.numeric(rawfromJSON$scoreboard$games[[k]]$startTimeEpoch), origin = '1970-01-01')
,current_period  = rawfromJSON$scoreboard$games[[k]]$currentPeriod
,final_message   = rawfromJSON$scoreboard$games[[k]]$finalMessage
,game_status     = rawfromJSON$scoreboard$games[[k]]$gameStatus
,period_status   = rawfromJSON$scoreboard$games[[k]]$periodStatus
,down_to_go      = rawfromJSON$scoreboard$games[[k]]$downToGo
,timeclock       = rawfromJSON$scoreboard$games[[k]]$timeclock
,network_logo    = rawfromJSON$scoreboard$games[[k]]$network_logo
,location        = rawfromJSON$scoreboard$games[[k]]$location
,contest_name    = rawfromJSON$scoreboard$games[[k]]$contestName
,url             = rawfromJSON$scoreboard$games[[k]]$url
,highlights_url  = rawfromJSON$scoreboard$games[[k]]$highlightsUrl
,live_audio_url  = rawfromJSON$scoreboard$games[[k]]$liveAudioUrl
,game_center_url = rawfromJSON$scoreboard$games[[k]]$gameCenterUrl
,HomeAway
,rawfromJSON$scoreboard$games[[k]]$alerts
,jsonLinks
# ,champ_info      = rawfromJSON$scoreboard$games[[k]]$champInfo
#     ,videos          = rawfromJSON$scoreboard$games[[k]]$videos
#     ,score_breakdown = rawfromJSON$scoreboard$games[[k]]$scoreBreakdown
#     ,home            =
#     ,away            = rawfromJSON$scoreboard$games[[k]]$away
#     ,tabs            = rawfromJSON$scoreboard$games[[k]]$tabs
#     ,tabs_array      = rawfromJSON$scoreboard$games[[k]]$tabsArray
#     ,status          = rawfromJSON$scoreboard$games[[k]]$status
#     ,alerts          = rawfromJSON$scoreboard$games[[k]]$alerts
)
}
foreach(k = 1:length(rawfromJSON$scoreboard$games), .combine = 'rbind', .verbose = TRUE) %do% {
HomeStuff <- rawfromJSON$scoreboard$games[[k]]$home
colnames(HomeStuff) = paste0('home.', colnames(HomeStuff))
homeQuarters <- data.frame(do.call(rbind, HomeStuff$home.scoreBreakdown))
colnames(homeQuarters) = c('home.quarter1.score','home.quarter2.score','home.quarter3.score','home.quarter4.score')
AwayStuff <- rawfromJSON$scoreboard$games[[k]]$home
colnames(AwayStuff) = paste0('away.', colnames(AwayStuff))
awayQuarters <- data.frame(do.call(rbind, AwayStuff$away.scoreBreakdown))
colnames(awayQuarters) = c('away.quarter1.score','away.quarter2.score','away.quarter3.score','away.quarter4.score')
HomeAway <- data.frame(
HomeStuff %>% dplyr::select(-home.scoreBreakdown)
,sapply(homeQuarters, as.numeric)
,AwayStuff %>% dplyr::select(-away.scoreBreakdown)
,sapply(awayQuarters, as.numeric)
)
jsonLinks <- foreach(i = 1:length(rawfromJSON$scoreboard$games[[k]]$tabsArray), .combine = 'rbind') %do% {
tabsarray <- rawfromJSON$scoreboard$games[[k]]$tabsArray[[i]][[1]]
recapURL = tabsarray$file[tabsarray$title == 'Recap']
boxScoreURL = tabsarray$file[tabsarray$title == 'Box Score']
scoringURL = tabsarray$file[tabsarray$title == 'Scoring']
teamStatsURL = tabsarray$file[tabsarray$title == 'Team Stats']
pbpURL = tabsarray$file[tabsarray$title == 'Play-By-Play']
data.frame(
recapURL = ifelse(length(recapURL) == 0, NA, recapURL)
,boxScoreURL = ifelse(length(boxScoreURL) == 0, NA, boxScoreURL)
,scoringURL = ifelse(length(scoringURL) == 0, NA, scoringURL)
,teamStatsURL = ifelse(length(teamStatsURL) == 0, NA, teamStatsURL)
,pbpURL = ifelse(length(pbpURL) == 0, NA, pbpURL)
)
}
rawfromJSON$scoreboard$games[[k]]$tabsArray
data.frame(
ncaa_id          = rawfromJSON$scoreboard$games[[k]]$id
,conference      = rawfromJSON$scoreboard$games[[k]]$conference
,game_state      = rawfromJSON$scoreboard$games[[k]]$gameState
,start_ts        = as.POSIXct(as.numeric(rawfromJSON$scoreboard$games[[k]]$startTimeEpoch), origin = '1970-01-01')
,current_period  = rawfromJSON$scoreboard$games[[k]]$currentPeriod
,final_message   = rawfromJSON$scoreboard$games[[k]]$finalMessage
,game_status     = rawfromJSON$scoreboard$games[[k]]$gameStatus
,period_status   = rawfromJSON$scoreboard$games[[k]]$periodStatus
,down_to_go      = rawfromJSON$scoreboard$games[[k]]$downToGo
,timeclock       = rawfromJSON$scoreboard$games[[k]]$timeclock
,network_logo    = rawfromJSON$scoreboard$games[[k]]$network_logo
,location        = rawfromJSON$scoreboard$games[[k]]$location
,contest_name    = rawfromJSON$scoreboard$games[[k]]$contestName
,url             = rawfromJSON$scoreboard$games[[k]]$url
,highlights_url  = rawfromJSON$scoreboard$games[[k]]$highlightsUrl
,live_audio_url  = rawfromJSON$scoreboard$games[[k]]$liveAudioUrl
,game_center_url = rawfromJSON$scoreboard$games[[k]]$gameCenterUrl
,HomeAway
,rawfromJSON$scoreboard$games[[k]]$alerts
,jsonLinks
# ,champ_info      = rawfromJSON$scoreboard$games[[k]]$champInfo
#     ,videos          = rawfromJSON$scoreboard$games[[k]]$videos
#     ,score_breakdown = rawfromJSON$scoreboard$games[[k]]$scoreBreakdown
#     ,home            =
#     ,away            = rawfromJSON$scoreboard$games[[k]]$away
#     ,tabs            = rawfromJSON$scoreboard$games[[k]]$tabs
#     ,tabs_array      = rawfromJSON$scoreboard$games[[k]]$tabsArray
#     ,status          = rawfromJSON$scoreboard$games[[k]]$status
#     ,alerts          = rawfromJSON$scoreboard$games[[k]]$alerts
)
}
k = 4
HomeStuff <- rawfromJSON$scoreboard$games[[k]]$home
colnames(HomeStuff) = paste0('home.', colnames(HomeStuff))
homeQuarters <- data.frame(do.call(rbind, HomeStuff$home.scoreBreakdown))
colnames(homeQuarters) = c('home.quarter1.score','home.quarter2.score','home.quarter3.score','home.quarter4.score')
AwayStuff <- rawfromJSON$scoreboard$games[[k]]$home
colnames(AwayStuff) = paste0('away.', colnames(AwayStuff))
awayQuarters <- data.frame(do.call(rbind, AwayStuff$away.scoreBreakdown))
colnames(awayQuarters) = c('away.quarter1.score','away.quarter2.score','away.quarter3.score','away.quarter4.score')
HomeAway <- data.frame(
HomeStuff %>% dplyr::select(-home.scoreBreakdown)
,sapply(homeQuarters, as.numeric)
,AwayStuff %>% dplyr::select(-away.scoreBreakdown)
,sapply(awayQuarters, as.numeric)
)
HomeStuff %>% dplyr::select(-home.scoreBreakdown)
sapply(homeQuarters, as.numeric)
AwayStuff %>% dplyr::select(-away.scoreBreakdown)
sapply(awayQuarters, as.numeric)
HomeAway <- data.frame(
HomeStuff %>% dplyr::select(-home.scoreBreakdown)
,sapply(homeQuarters, as.numeric)
,AwayStuff %>% dplyr::select(-away.scoreBreakdown)
,sapply(awayQuarters, as.numeric)
)
sapply(homeQuarters, as.numeric)
homeQuarters
HomeAway <- data.frame(
HomeStuff %>% dplyr::select(-home.scoreBreakdown)
,sapply(homeQuarters, function(x){as.numeric(as.character(x))})
,AwayStuff %>% dplyr::select(-away.scoreBreakdown)
,sapply(awayQuarters, function(x){as.numeric(as.character(x))})
)
sapply(awayQuarters, function(x){as.numeric(as.character(x))})
AwayStuff %>% dplyr::select(-away.scoreBreakdown)
class(AwayStuff %>% dplyr::select(-away.scoreBreakdown))
HomeStuff %>% dplyr::select(-home.scoreBreakdown)
HomeStuff %>% dplyr::select(-home.scoreBreakdown)
HomeStuff %>% dplyr::select(-home.scoreBreakdown)
%>% dim
HomeStuff %>% dplyr::select(-home.scoreBreakdown) %>% dim
sapply(homeQuarters, function(x){as.numeric(as.character(x))}) %>% dim
sapply(homeQuarters, function(x){as.numeric(as.character(x))})
data.frame(sapply(homeQuarters, function(x){as.numeric(as.character(x))}))
data.frame(sapply(homeQuarters, function(x){as.numeric(as.character(x))})) %>% t
HomeAway <- data.frame(
HomeStuff %>% dplyr::select(-home.scoreBreakdown)
,data.frame(sapply(homeQuarters, function(x){as.numeric(as.character(x))})) %>% t
,AwayStuff %>% dplyr::select(-away.scoreBreakdown)
)
HomeAway
HomeAway <- data.frame(
HomeStuff %>% dplyr::select(-home.scoreBreakdown)
,data.frame(sapply(homeQuarters, function(x){as.numeric(as.character(x))})) %>% t
,AwayStuff %>% dplyr::select(-away.scoreBreakdown)
,data.frame(sapply(awayQuarters, function(x){as.numeric(as.character(x))})) %>% t
)
HomeAway
foreach(k = 1:length(rawfromJSON$scoreboard$games), .combine = 'rbind', .verbose = TRUE) %do% {
HomeStuff <- rawfromJSON$scoreboard$games[[k]]$home
colnames(HomeStuff) = paste0('home.', colnames(HomeStuff))
homeQuarters <- data.frame(do.call(rbind, HomeStuff$home.scoreBreakdown))
colnames(homeQuarters) = c('home.quarter1.score','home.quarter2.score','home.quarter3.score','home.quarter4.score')
AwayStuff <- rawfromJSON$scoreboard$games[[k]]$home
colnames(AwayStuff) = paste0('away.', colnames(AwayStuff))
awayQuarters <- data.frame(do.call(rbind, AwayStuff$away.scoreBreakdown))
colnames(awayQuarters) = c('away.quarter1.score','away.quarter2.score','away.quarter3.score','away.quarter4.score')
HomeAway <- data.frame(
HomeStuff %>% dplyr::select(-home.scoreBreakdown)
,data.frame(sapply(homeQuarters, function(x){as.numeric(as.character(x))})) %>% t
,AwayStuff %>% dplyr::select(-away.scoreBreakdown)
,data.frame(sapply(awayQuarters, function(x){as.numeric(as.character(x))})) %>% t
)
jsonLinks <- foreach(i = 1:length(rawfromJSON$scoreboard$games[[k]]$tabsArray), .combine = 'rbind') %do% {
tabsarray <- rawfromJSON$scoreboard$games[[k]]$tabsArray[[i]][[1]]
recapURL = tabsarray$file[tabsarray$title == 'Recap']
boxScoreURL = tabsarray$file[tabsarray$title == 'Box Score']
scoringURL = tabsarray$file[tabsarray$title == 'Scoring']
teamStatsURL = tabsarray$file[tabsarray$title == 'Team Stats']
pbpURL = tabsarray$file[tabsarray$title == 'Play-By-Play']
data.frame(
recapURL = ifelse(length(recapURL) == 0, NA, recapURL)
,boxScoreURL = ifelse(length(boxScoreURL) == 0, NA, boxScoreURL)
,scoringURL = ifelse(length(scoringURL) == 0, NA, scoringURL)
,teamStatsURL = ifelse(length(teamStatsURL) == 0, NA, teamStatsURL)
,pbpURL = ifelse(length(pbpURL) == 0, NA, pbpURL)
)
}
rawfromJSON$scoreboard$games[[k]]$tabsArray
data.frame(
ncaa_id          = rawfromJSON$scoreboard$games[[k]]$id
,conference      = rawfromJSON$scoreboard$games[[k]]$conference
,game_state      = rawfromJSON$scoreboard$games[[k]]$gameState
,start_ts        = as.POSIXct(as.numeric(rawfromJSON$scoreboard$games[[k]]$startTimeEpoch), origin = '1970-01-01')
,current_period  = rawfromJSON$scoreboard$games[[k]]$currentPeriod
,final_message   = rawfromJSON$scoreboard$games[[k]]$finalMessage
,game_status     = rawfromJSON$scoreboard$games[[k]]$gameStatus
,period_status   = rawfromJSON$scoreboard$games[[k]]$periodStatus
,down_to_go      = rawfromJSON$scoreboard$games[[k]]$downToGo
,timeclock       = rawfromJSON$scoreboard$games[[k]]$timeclock
,network_logo    = rawfromJSON$scoreboard$games[[k]]$network_logo
,location        = rawfromJSON$scoreboard$games[[k]]$location
,contest_name    = rawfromJSON$scoreboard$games[[k]]$contestName
,url             = rawfromJSON$scoreboard$games[[k]]$url
,highlights_url  = rawfromJSON$scoreboard$games[[k]]$highlightsUrl
,live_audio_url  = rawfromJSON$scoreboard$games[[k]]$liveAudioUrl
,game_center_url = rawfromJSON$scoreboard$games[[k]]$gameCenterUrl
,HomeAway
,rawfromJSON$scoreboard$games[[k]]$alerts
,jsonLinks
# ,champ_info      = rawfromJSON$scoreboard$games[[k]]$champInfo
#     ,videos          = rawfromJSON$scoreboard$games[[k]]$videos
#     ,score_breakdown = rawfromJSON$scoreboard$games[[k]]$scoreBreakdown
#     ,home            =
#     ,away            = rawfromJSON$scoreboard$games[[k]]$away
#     ,tabs            = rawfromJSON$scoreboard$games[[k]]$tabs
#     ,tabs_array      = rawfromJSON$scoreboard$games[[k]]$tabsArray
#     ,status          = rawfromJSON$scoreboard$games[[k]]$status
#     ,alerts          = rawfromJSON$scoreboard$games[[k]]$alerts
)
}
HomeAway <- data.frame(
HomeStuff %>% dplyr::select(-home.scoreBreakdown)
,sapply(homeQuarters, function(x){as.numeric(as.character(x))})
,AwayStuff %>% dplyr::select(-away.scoreBreakdown)
,sapply(awayQuarters, function(x){as.numeric(as.character(x))})
)
k
k = 1
HomeAway <- data.frame(
HomeStuff %>% dplyr::select(-home.scoreBreakdown)
,sapply(homeQuarters, function(x){as.numeric(as.character(x))})
,AwayStuff %>% dplyr::select(-away.scoreBreakdown)
,sapply(awayQuarters, function(x){as.numeric(as.character(x))})
)
HomeStuff <- rawfromJSON$scoreboard$games[[k]]$home
colnames(HomeStuff) = paste0('home.', colnames(HomeStuff))
homeQuarters <- data.frame(do.call(rbind, HomeStuff$home.scoreBreakdown))
colnames(homeQuarters) = c('home.quarter1.score','home.quarter2.score','home.quarter3.score','home.quarter4.score')
AwayStuff <- rawfromJSON$scoreboard$games[[k]]$home
colnames(AwayStuff) = paste0('away.', colnames(AwayStuff))
awayQuarters <- data.frame(do.call(rbind, AwayStuff$away.scoreBreakdown))
colnames(awayQuarters) = c('away.quarter1.score','away.quarter2.score','away.quarter3.score','away.quarter4.score')
HomeAway <- data.frame(
HomeStuff %>% dplyr::select(-home.scoreBreakdown)
,sapply(homeQuarters, function(x){as.numeric(as.character(x))})
,AwayStuff %>% dplyr::select(-away.scoreBreakdown)
,sapply(awayQuarters, function(x){as.numeric(as.character(x))})
)
k = 2
HomeStuff <- rawfromJSON$scoreboard$games[[k]]$home
colnames(HomeStuff) = paste0('home.', colnames(HomeStuff))
homeQuarters <- data.frame(do.call(rbind, HomeStuff$home.scoreBreakdown))
colnames(homeQuarters) = c('home.quarter1.score','home.quarter2.score','home.quarter3.score','home.quarter4.score')
AwayStuff <- rawfromJSON$scoreboard$games[[k]]$home
colnames(AwayStuff) = paste0('away.', colnames(AwayStuff))
awayQuarters <- data.frame(do.call(rbind, AwayStuff$away.scoreBreakdown))
colnames(awayQuarters) = c('away.quarter1.score','away.quarter2.score','away.quarter3.score','away.quarter4.score')
HomeAway <- data.frame(
HomeStuff %>% dplyr::select(-home.scoreBreakdown)
,sapply(homeQuarters, function(x){as.numeric(as.character(x))})
,AwayStuff %>% dplyr::select(-away.scoreBreakdown)
,sapply(awayQuarters, function(x){as.numeric(as.character(x))})
)
k = 3
HomeStuff <- rawfromJSON$scoreboard$games[[k]]$home
colnames(HomeStuff) = paste0('home.', colnames(HomeStuff))
homeQuarters <- data.frame(do.call(rbind, HomeStuff$home.scoreBreakdown))
colnames(homeQuarters) = c('home.quarter1.score','home.quarter2.score','home.quarter3.score','home.quarter4.score')
AwayStuff <- rawfromJSON$scoreboard$games[[k]]$home
colnames(AwayStuff) = paste0('away.', colnames(AwayStuff))
awayQuarters <- data.frame(do.call(rbind, AwayStuff$away.scoreBreakdown))
colnames(awayQuarters) = c('away.quarter1.score','away.quarter2.score','away.quarter3.score','away.quarter4.score')
HomeAway <- data.frame(
HomeStuff %>% dplyr::select(-home.scoreBreakdown)
,sapply(homeQuarters, function(x){as.numeric(as.character(x))})
,AwayStuff %>% dplyr::select(-away.scoreBreakdown)
,sapply(awayQuarters, function(x){as.numeric(as.character(x))})
)
homeQuarters
HomeStuff <- rawfromJSON$scoreboard$games[[k]]$home
colnames(HomeStuff) = paste0('home.', colnames(HomeStuff))
homeQuarters <- data.frame(do.call(rbind, HomeStuff$home.scoreBreakdown))
HomeStuff
HomeStuff$home.scoreBreakdown
foreach(k = 1:length(rawfromJSON$scoreboard$games), .combine = 'rbind', .verbose = TRUE) %do% {
#   HomeStuff <- rawfromJSON$scoreboard$games[[k]]$home
#   colnames(HomeStuff) = paste0('home.', colnames(HomeStuff))
#
#   homeQuarters <- data.frame(do.call(rbind, HomeStuff$home.scoreBreakdown))
#
#   colnames(homeQuarters) = c('home.quarter1.score','home.quarter2.score','home.quarter3.score','home.quarter4.score')
#
#
#   AwayStuff <- rawfromJSON$scoreboard$games[[k]]$home
#   colnames(AwayStuff) = paste0('away.', colnames(AwayStuff))
#
#   awayQuarters <- data.frame(do.call(rbind, AwayStuff$away.scoreBreakdown))
#
#   colnames(awayQuarters) = c('away.quarter1.score','away.quarter2.score','away.quarter3.score','away.quarter4.score')
#
#   HomeAway <- data.frame(
#     HomeStuff %>% dplyr::select(-home.scoreBreakdown)
#     ,sapply(homeQuarters, function(x){as.numeric(as.character(x))})
#     ,AwayStuff %>% dplyr::select(-away.scoreBreakdown)
#     ,sapply(awayQuarters, function(x){as.numeric(as.character(x))})
#   )
#
jsonLinks <- foreach(i = 1:length(rawfromJSON$scoreboard$games[[k]]$tabsArray), .combine = 'rbind') %do% {
tabsarray <- rawfromJSON$scoreboard$games[[k]]$tabsArray[[i]][[1]]
recapURL = tabsarray$file[tabsarray$title == 'Recap']
boxScoreURL = tabsarray$file[tabsarray$title == 'Box Score']
scoringURL = tabsarray$file[tabsarray$title == 'Scoring']
teamStatsURL = tabsarray$file[tabsarray$title == 'Team Stats']
pbpURL = tabsarray$file[tabsarray$title == 'Play-By-Play']
data.frame(
recapURL = ifelse(length(recapURL) == 0, NA, recapURL)
,boxScoreURL = ifelse(length(boxScoreURL) == 0, NA, boxScoreURL)
,scoringURL = ifelse(length(scoringURL) == 0, NA, scoringURL)
,teamStatsURL = ifelse(length(teamStatsURL) == 0, NA, teamStatsURL)
,pbpURL = ifelse(length(pbpURL) == 0, NA, pbpURL)
)
}
rawfromJSON$scoreboard$games[[k]]$tabsArray
data.frame(
ncaa_id          = rawfromJSON$scoreboard$games[[k]]$id
,conference      = rawfromJSON$scoreboard$games[[k]]$conference
,game_state      = rawfromJSON$scoreboard$games[[k]]$gameState
,start_ts        = as.POSIXct(as.numeric(rawfromJSON$scoreboard$games[[k]]$startTimeEpoch), origin = '1970-01-01')
,current_period  = rawfromJSON$scoreboard$games[[k]]$currentPeriod
,final_message   = rawfromJSON$scoreboard$games[[k]]$finalMessage
,game_status     = rawfromJSON$scoreboard$games[[k]]$gameStatus
,period_status   = rawfromJSON$scoreboard$games[[k]]$periodStatus
,down_to_go      = rawfromJSON$scoreboard$games[[k]]$downToGo
,timeclock       = rawfromJSON$scoreboard$games[[k]]$timeclock
,network_logo    = rawfromJSON$scoreboard$games[[k]]$network_logo
,location        = rawfromJSON$scoreboard$games[[k]]$location
,contest_name    = rawfromJSON$scoreboard$games[[k]]$contestName
,url             = rawfromJSON$scoreboard$games[[k]]$url
,highlights_url  = rawfromJSON$scoreboard$games[[k]]$highlightsUrl
,live_audio_url  = rawfromJSON$scoreboard$games[[k]]$liveAudioUrl
,game_center_url = rawfromJSON$scoreboard$games[[k]]$gameCenterUrl
# ,HomeAway
,rawfromJSON$scoreboard$games[[k]]$alerts
,jsonLinks
# ,champ_info      = rawfromJSON$scoreboard$games[[k]]$champInfo
#     ,videos          = rawfromJSON$scoreboard$games[[k]]$videos
#     ,score_breakdown = rawfromJSON$scoreboard$games[[k]]$scoreBreakdown
#     ,home            =
#     ,away            = rawfromJSON$scoreboard$games[[k]]$away
#     ,tabs            = rawfromJSON$scoreboard$games[[k]]$tabs
#     ,tabs_array      = rawfromJSON$scoreboard$games[[k]]$tabsArray
#     ,status          = rawfromJSON$scoreboard$games[[k]]$status
#     ,alerts          = rawfromJSON$scoreboard$games[[k]]$alerts
)
}
tabsarray <- rawfromJSON$scoreboard$games[[k]]$tabsArray[[i]][[1]]
recapURL = tabsarray$file[tabsarray$title == 'Recap']
boxScoreURL = tabsarray$file[tabsarray$title == 'Box Score']
scoringURL = tabsarray$file[tabsarray$title == 'Scoring']
teamStatsURL = tabsarray$file[tabsarray$title == 'Team Stats']
pbpURL = tabsarray$file[tabsarray$title == 'Play-By-Play']
data.frame(
recapURL =
gsub('/sites/default/files/data/'
,'http://data.ncaa.com/jsonp/'
,ifelse(length(recapURL) == 0, NA, recapURL))
,boxScoreURL = gsub('/sites/default/files/data/'
,'http://data.ncaa.com/jsonp/'
,ifelse(length(boxScoreURL) == 0, NA, boxScoreURL))
,scoringURL = gsub('/sites/default/files/data/'
,'http://data.ncaa.com/jsonp/'
,ifelse(length(scoringURL) == 0, NA, scoringURL))
,teamStatsURL = gsub('/sites/default/files/data/'
,'http://data.ncaa.com/jsonp/'
,ifelse(length(teamStatsURL) == 0, NA, teamStatsURL))
,pbpURL = gsub('/sites/default/files/data/'
,'http://data.ncaa.com/jsonp/'
,ifelse(length(pbpURL) == 0, NA, pbpURL))
)
}
NCAAscoreboard <- function(url){
raw<-suppressWarnings(readLines(url))
rawfromJSON <- fromJSON((gsub('callbackWrapper\\(','',gsub('\\}\\)\\;','\\}',raw))))
foreach(k = 1:length(rawfromJSON$scoreboard$games), .combine = 'rbind', .verbose = TRUE) %do% {
#   HomeStuff <- rawfromJSON$scoreboard$games[[k]]$home
#   colnames(HomeStuff) = paste0('home.', colnames(HomeStuff))
#
#   homeQuarters <- data.frame(do.call(rbind, HomeStuff$home.scoreBreakdown))
#
#   colnames(homeQuarters) = c('home.quarter1.score','home.quarter2.score','home.quarter3.score','home.quarter4.score')
#
#
#   AwayStuff <- rawfromJSON$scoreboard$games[[k]]$home
#   colnames(AwayStuff) = paste0('away.', colnames(AwayStuff))
#
#   awayQuarters <- data.frame(do.call(rbind, AwayStuff$away.scoreBreakdown))
#
#   colnames(awayQuarters) = c('away.quarter1.score','away.quarter2.score','away.quarter3.score','away.quarter4.score')
#
#   HomeAway <- data.frame(
#     HomeStuff %>% dplyr::select(-home.scoreBreakdown)
#     ,sapply(homeQuarters, function(x){as.numeric(as.character(x))})
#     ,AwayStuff %>% dplyr::select(-away.scoreBreakdown)
#     ,sapply(awayQuarters, function(x){as.numeric(as.character(x))})
#   )
#
jsonLinks <- foreach(i = 1:length(rawfromJSON$scoreboard$games[[k]]$tabsArray), .combine = 'rbind') %do% {
tabsarray <- rawfromJSON$scoreboard$games[[k]]$tabsArray[[i]][[1]]
recapURL = tabsarray$file[tabsarray$title == 'Recap']
boxScoreURL = tabsarray$file[tabsarray$title == 'Box Score']
scoringURL = tabsarray$file[tabsarray$title == 'Scoring']
teamStatsURL = tabsarray$file[tabsarray$title == 'Team Stats']
pbpURL = tabsarray$file[tabsarray$title == 'Play-By-Play']
data.frame(
recapURL =
gsub('/sites/default/files/data/'
,'http://data.ncaa.com/jsonp/'
,ifelse(length(recapURL) == 0, NA, recapURL))
,boxScoreURL = gsub('/sites/default/files/data/'
,'http://data.ncaa.com/jsonp/'
,ifelse(length(boxScoreURL) == 0, NA, boxScoreURL))
,scoringURL = gsub('/sites/default/files/data/'
,'http://data.ncaa.com/jsonp/'
,ifelse(length(scoringURL) == 0, NA, scoringURL))
,teamStatsURL = gsub('/sites/default/files/data/'
,'http://data.ncaa.com/jsonp/'
,ifelse(length(teamStatsURL) == 0, NA, teamStatsURL))
,pbpURL = gsub('/sites/default/files/data/'
,'http://data.ncaa.com/jsonp/'
,ifelse(length(pbpURL) == 0, NA, pbpURL))
)
}
rawfromJSON$scoreboard$games[[k]]$tabsArray
data.frame(
ncaa_id          = rawfromJSON$scoreboard$games[[k]]$id
,conference      = rawfromJSON$scoreboard$games[[k]]$conference
,game_state      = rawfromJSON$scoreboard$games[[k]]$gameState
,start_ts        = as.POSIXct(as.numeric(rawfromJSON$scoreboard$games[[k]]$startTimeEpoch), origin = '1970-01-01')
,current_period  = rawfromJSON$scoreboard$games[[k]]$currentPeriod
,final_message   = rawfromJSON$scoreboard$games[[k]]$finalMessage
,game_status     = rawfromJSON$scoreboard$games[[k]]$gameStatus
,period_status   = rawfromJSON$scoreboard$games[[k]]$periodStatus
,down_to_go      = rawfromJSON$scoreboard$games[[k]]$downToGo
,timeclock       = rawfromJSON$scoreboard$games[[k]]$timeclock
,network_logo    = rawfromJSON$scoreboard$games[[k]]$network_logo
,location        = rawfromJSON$scoreboard$games[[k]]$location
,contest_name    = rawfromJSON$scoreboard$games[[k]]$contestName
,url             = rawfromJSON$scoreboard$games[[k]]$url
,highlights_url  = rawfromJSON$scoreboard$games[[k]]$highlightsUrl
,live_audio_url  = rawfromJSON$scoreboard$games[[k]]$liveAudioUrl
,game_center_url = rawfromJSON$scoreboard$games[[k]]$gameCenterUrl
# ,HomeAway
,rawfromJSON$scoreboard$games[[k]]$alerts
,jsonLinks
# ,champ_info      = rawfromJSON$scoreboard$games[[k]]$champInfo
#     ,videos          = rawfromJSON$scoreboard$games[[k]]$videos
#     ,score_breakdown = rawfromJSON$scoreboard$games[[k]]$scoreBreakdown
#     ,home            =
#     ,away            = rawfromJSON$scoreboard$games[[k]]$away
#     ,tabs            = rawfromJSON$scoreboard$games[[k]]$tabs
#     ,tabs_array      = rawfromJSON$scoreboard$games[[k]]$tabsArray
#     ,status          = rawfromJSON$scoreboard$games[[k]]$status
#     ,alerts          = rawfromJSON$scoreboard$games[[k]]$alerts
)
}
}
library(cfb)
NCAAscoreboard(url)
NCAAscoreboard(url) %>% dim
rr<-NCAAscoreboard(url)
dim(rr)
library(cfb)
rr<-NCAAscoreboard(url)
url
